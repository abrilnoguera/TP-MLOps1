{"timestamp":"2025-08-02T21:53:10.348943","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-02T21:53:10.349866","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_process.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-02T21:53:11.977714","level":"info","event":"Found credentials in environment variables.","logger":"botocore.credentials"}
{"timestamp":"2025-08-02T21:53:12.031908","level":"info","event":"Found endpoint for s3 via: environment_service.","logger":"botocore.configprovider"}
{"timestamp":"2025-08-02T21:53:14.083277Z","level":"info","event":"Las columnas de tipo categóricas son:  ['listing_url', 'last_scraped', 'source', 'name', 'description', 'neighborhood_overview', 'picture_url', 'host_url', 'host_name', 'host_since', 'host_location', 'host_about', 'host_response_time', 'host_is_superhost', 'host_thumbnail_url', 'host_picture_url', 'host_neighbourhood', 'host_verifications', 'host_has_profile_pic', 'host_identity_verified', 'neighbourhood', 'neighbourhood_cleansed', 'property_type', 'room_type', 'bathrooms_text', 'amenities', 'has_availability', 'calendar_last_scraped', 'first_review', 'last_review', 'license', 'instant_bookable', 'city']","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-02T21:53:14.083859Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-02T21:53:14.089928Z","level":"info","event":"Las columnas de tipo numéricas son:  ['id', 'scrape_id', 'host_id', 'host_response_rate', 'host_acceptance_rate', 'host_listings_count', 'host_total_listings_count', 'neighbourhood_group_cleansed', 'latitude', 'longitude', 'accommodates', 'bathrooms', 'bedrooms', 'beds', 'price', 'minimum_nights', 'maximum_nights', 'minimum_minimum_nights', 'maximum_minimum_nights', 'minimum_maximum_nights', 'maximum_maximum_nights', 'minimum_nights_avg_ntm', 'maximum_nights_avg_ntm', 'calendar_updated', 'availability_30', 'availability_60', 'availability_90', 'availability_365', 'number_of_reviews', 'number_of_reviews_ltm', 'number_of_reviews_l30d', 'availability_eoy', 'number_of_reviews_ly', 'estimated_occupancy_l365d', 'estimated_revenue_l365d', 'review_scores_rating', 'review_scores_accuracy', 'review_scores_cleanliness', 'review_scores_checkin', 'review_scores_communication', 'review_scores_location', 'review_scores_value', 'calculated_host_listings_count', 'calculated_host_listings_count_entire_homes', 'calculated_host_listings_count_private_rooms', 'calculated_host_listings_count_shared_rooms', 'reviews_per_month']","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-02T21:53:14.368142Z","level":"info","event":"Columnas eliminadas (3): ['neighbourhood_group_cleansed', 'calendar_updated', 'license']","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-02T21:53:14.887681Z","level":"info","event":"Filas eliminadas: 3581","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-02T21:53:19.757389","level":"info","event":"Found credentials in environment variables.","logger":"botocore.credentials"}
{"timestamp":"2025-08-02T21:53:19.839058","level":"info","event":"Found endpoint for s3 via: environment_service.","logger":"botocore.configprovider"}
{"timestamp":"2025-08-02T21:53:21.900165","level":"info","event":"Found credentials in environment variables.","logger":"botocore.credentials"}
{"timestamp":"2025-08-02T21:53:21.943268","level":"info","event":"Found endpoint for s3 via: environment_service.","logger":"botocore.configprovider"}
{"timestamp":"2025-08-02T21:53:22.213968","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/variable.py:147: DeprecationWarning: Using Variable.get from `airflow.models` is deprecated.Please use `from airflow.sdk import Variable` instead\n  warnings.warn(\n","logger":"py.warnings"}
{"timestamp":"2025-08-02T21:53:22.227784","level":"error","event":"Unable to retrieve variable from secrets backend (LocalFilesystemBackend). Checking subsequent secrets backend.","logger":"task","error_detail":[{"exc_type":"AirflowException","exc_value":"The \"/opt/secrets/variables.yaml\" file contains multiple values for keys: ['feature_cols', 'cat_cols']","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/context.py","lineno":178,"name":"_get_variable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/local_filesystem.py","lineno":310,"name":"get_variable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/local_filesystem.py","lineno":293,"name":"_local_variables"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/local_filesystem.py","lineno":238,"name":"load_variables"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-08-02T21:53:22.598192","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"TypeError","exc_value":"unhashable type: 'list'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":867,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1159,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":251,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/etl_process.py","lineno":263,"name":"preprocess_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/series.py","lineno":2291,"name":"unique"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/base.py","lineno":1025,"name":"unique"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/algorithms.py","lineno":401,"name":"unique"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/algorithms.py","lineno":440,"name":"unique_with_mask"},{"filename":"/opt/airflow/pandas/_libs/hashtable_class_helper.pxi","lineno":7247,"name":"pandas._libs.hashtable.PyObjectHashTable.unique"},{"filename":"/opt/airflow/pandas/_libs/hashtable_class_helper.pxi","lineno":7194,"name":"pandas._libs.hashtable.PyObjectHashTable._unique"}],"is_group":false,"exceptions":[]}]}
